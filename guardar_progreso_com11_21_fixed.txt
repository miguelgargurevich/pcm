
      // COMPROMISO 11
      else if (parseInt(formData.compromisoId) === 11) {
        console.log('üöÄ Preparando datos para Com11');
        
        const com11Data = {
          compromisoId: 11,
          entidadId: user.entidadId,
          pdfAportacion: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com11 a enviar:', com11Data);
        
        if (com11RecordId) {
          console.log('Actualizando registro existente Com11:', com11RecordId);
          response = await com11AportacionGeoPeruService.update(com11RecordId, com11Data);
        } else {
          console.log('Creando nuevo registro Com11');
          response = await com11AportacionGeoPeruService.create(com11Data);
          console.log('Respuesta create Com11:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com11:', response.data.id);
            setCom11RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com11:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com11');
          
          if (response.data.pdfAportacion) {
            setPdfUrl(response.data.pdfAportacion);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 12
      else if (parseInt(formData.compromisoId) === 12) {
        console.log('üöÄ Preparando datos para Com12');
        
        const com12Data = {
          compromisoId: 12,
          entidadId: user.entidadId,
          pdfResolucion: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com12 a enviar:', com12Data);
        
        if (com12RecordId) {
          console.log('Actualizando registro existente Com12:', com12RecordId);
          response = await com12DelegadoProteccionDatosService.update(com12RecordId, com12Data);
        } else {
          console.log('Creando nuevo registro Com12');
          response = await com12DelegadoProteccionDatosService.create(com12Data);
          console.log('Respuesta create Com12:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com12:', response.data.id);
            setCom12RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com12:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com12');
          
          if (response.data.pdfResolucion) {
            setPdfUrl(response.data.pdfResolucion);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 13
      else if (parseInt(formData.compromisoId) === 13) {
        console.log('üöÄ Preparando datos para Com13');
        
        const com13Data = {
          compromisoId: 13,
          entidadId: user.entidadId,
          pdfConvenio: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com13 a enviar:', com13Data);
        
        if (com13RecordId) {
          console.log('Actualizando registro existente Com13:', com13RecordId);
          response = await com13IntegracionPlataformaService.update(com13RecordId, com13Data);
        } else {
          console.log('Creando nuevo registro Com13');
          response = await com13IntegracionPlataformaService.create(com13Data);
          console.log('Respuesta create Com13:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com13:', response.data.id);
            setCom13RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com13:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com13');
          
          if (response.data.pdfConvenio) {
            setPdfUrl(response.data.pdfConvenio);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 14
      else if (parseInt(formData.compromisoId) === 14) {
        console.log('üöÄ Preparando datos para Com14');
        
        const com14Data = {
          compromisoId: 14,
          entidadId: user.entidadId,
          pdfResolucion: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com14 a enviar:', com14Data);
        
        if (com14RecordId) {
          console.log('Actualizando registro existente Com14:', com14RecordId);
          response = await com14OficialSeguridadInfoService.update(com14RecordId, com14Data);
        } else {
          console.log('Creando nuevo registro Com14');
          response = await com14OficialSeguridadInfoService.create(com14Data);
          console.log('Respuesta create Com14:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com14:', response.data.id);
            setCom14RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com14:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com14');
          
          if (response.data.pdfResolucion) {
            setPdfUrl(response.data.pdfResolucion);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 15
      else if (parseInt(formData.compromisoId) === 15) {
        console.log('üöÄ Preparando datos para Com15');
        
        const com15Data = {
          compromisoId: 15,
          entidadId: user.entidadId,
          pdfResolucion: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com15 a enviar:', com15Data);
        
        if (com15RecordId) {
          console.log('Actualizando registro existente Com15:', com15RecordId);
          response = await com15CsirtService.update(com15RecordId, com15Data);
        } else {
          console.log('Creando nuevo registro Com15');
          response = await com15CsirtService.create(com15Data);
          console.log('Respuesta create Com15:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com15:', response.data.id);
            setCom15RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com15:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com15');
          
          if (response.data.pdfResolucion) {
            setPdfUrl(response.data.pdfResolucion);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 16
      else if (parseInt(formData.compromisoId) === 16) {
        console.log('üöÄ Preparando datos para Com16');
        
        const com16Data = {
          compromisoId: 16,
          entidadId: user.entidadId,
          pdfSgsi: documentoUrl || null,
          pdfCertificacion: documentoUrl || null,  // TODO: handle second PDF
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com16 a enviar:', com16Data);
        
        if (com16RecordId) {
          console.log('Actualizando registro existente Com16:', com16RecordId);
          response = await com16SgsiService.update(com16RecordId, com16Data);
        } else {
          console.log('Creando nuevo registro Com16');
          response = await com16SgsiService.create(com16Data);
          console.log('Respuesta create Com16:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com16:', response.data.id);
            setCom16RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com16:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com16');
          
          if (response.data.pdfSgsi) {
            setPdfUrl(response.data.pdfSgsi);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 17
      else if (parseInt(formData.compromisoId) === 17) {
        console.log('üöÄ Preparando datos para Com17');
        
        const com17Data = {
          compromisoId: 17,
          entidadId: user.entidadId,
          pdfPlan: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com17 a enviar:', com17Data);
        
        if (com17RecordId) {
          console.log('Actualizando registro existente Com17:', com17RecordId);
          response = await com17PlanContinuidadService.update(com17RecordId, com17Data);
        } else {
          console.log('Creando nuevo registro Com17');
          response = await com17PlanContinuidadService.create(com17Data);
          console.log('Respuesta create Com17:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com17:', response.data.id);
            setCom17RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com17:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com17');
          
          if (response.data.pdfPlan) {
            setPdfUrl(response.data.pdfPlan);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 18
      else if (parseInt(formData.compromisoId) === 18) {
        console.log('üöÄ Preparando datos para Com18');
        
        const com18Data = {
          compromisoId: 18,
          entidadId: user.entidadId,
          pdfOficio: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com18 a enviar:', com18Data);
        
        if (com18RecordId) {
          console.log('Actualizando registro existente Com18:', com18RecordId);
          response = await com18PagoLineasService.update(com18RecordId, com18Data);
        } else {
          console.log('Creando nuevo registro Com18');
          response = await com18PagoLineasService.create(com18Data);
          console.log('Respuesta create Com18:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com18:', response.data.id);
            setCom18RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com18:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com18');
          
          if (response.data.pdfOficio) {
            setPdfUrl(response.data.pdfOficio);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 19
      else if (parseInt(formData.compromisoId) === 19) {
        console.log('üöÄ Preparando datos para Com19');
        
        const com19Data = {
          compromisoId: 19,
          entidadId: user.entidadId,
          pdfReporte: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com19 a enviar:', com19Data);
        
        if (com19RecordId) {
          console.log('Actualizando registro existente Com19:', com19RecordId);
          response = await com19AperturaDatosService.update(com19RecordId, com19Data);
        } else {
          console.log('Creando nuevo registro Com19');
          response = await com19AperturaDatosService.create(com19Data);
          console.log('Respuesta create Com19:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com19:', response.data.id);
            setCom19RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com19:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com19');
          
          if (response.data.pdfReporte) {
            setPdfUrl(response.data.pdfReporte);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 20
      else if (parseInt(formData.compromisoId) === 20) {
        console.log('üöÄ Preparando datos para Com20');
        
        const com20Data = {
          compromisoId: 20,
          entidadId: user.entidadId,
          pdfReporte: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com20 a enviar:', com20Data);
        
        if (com20RecordId) {
          console.log('Actualizando registro existente Com20:', com20RecordId);
          response = await com20DigitalizacionTramitesService.update(com20RecordId, com20Data);
        } else {
          console.log('Creando nuevo registro Com20');
          response = await com20DigitalizacionTramitesService.create(com20Data);
          console.log('Respuesta create Com20:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com20:', response.data.id);
            setCom20RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com20:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com20');
          
          if (response.data.pdfReporte) {
            setPdfUrl(response.data.pdfReporte);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }

      // COMPROMISO 21
      else if (parseInt(formData.compromisoId) === 21) {
        console.log('üöÄ Preparando datos para Com21');
        
        const com21Data = {
          compromisoId: 21,
          entidadId: user.entidadId,
          pdfResolucion: documentoUrl || null,
          criteriosEvaluados: formData.criteriosEvaluados ? JSON.stringify(formData.criteriosEvaluados) : null,
          checkPrivacidad: formData.aceptaPoliticaPrivacidad || false,
          checkDdjj: formData.aceptaDeclaracionJurada || false,
          usuarioRegistra: user.usuarioId,
          etapaFormulario: pasoActual === 1 ? 'paso1' : pasoActual === 2 ? 'paso2' : 'paso3',
          ...formData
        };
        
        console.log('Datos Com21 a enviar:', com21Data);
        
        if (com21RecordId) {
          console.log('Actualizando registro existente Com21:', com21RecordId);
          response = await com21OficialGobiernoDatosService.update(com21RecordId, com21Data);
        } else {
          console.log('Creando nuevo registro Com21');
          response = await com21OficialGobiernoDatosService.create(com21Data);
          console.log('Respuesta create Com21:', response);
          if (response.isSuccess && response.data) {
            console.log('ID del nuevo registro Com21:', response.data.id);
            setCom21RecordId(response.data.id);
          }
        }
        
        console.log('Respuesta final Com21:', response);
        
        // Actualizar estado local con datos guardados
        if (response.isSuccess && response.data) {
          console.log('‚úÖ Actualizando estado local Com21');
          
          if (response.data.pdfResolucion) {
            setPdfUrl(response.data.pdfResolucion);
            if (blobUrlToRevoke) {
              console.log('üßπ Revocando blob URL antiguo:', blobUrlToRevoke);
              URL.revokeObjectURL(blobUrlToRevoke);
            }
          }
          
          if (response.data.criteriosEvaluados) {
            try {
              const criteriosParsed = JSON.parse(response.data.criteriosEvaluados);
              setFormData(prev => ({ ...prev, criteriosEvaluados: criteriosParsed }));
            } catch (e) {
              console.error('‚ùå Error al parsear criterios:', e);
            }
          }
        }
      }